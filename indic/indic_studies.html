<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Analyse technique - Expérimentations</title>
<meta name="author" content="Roland Donat" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<link rel="stylesheet" type="text/css" href="https://edgemind-sas.github.io/visual-identity/official_docs/css/edgemind.css" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">Analyse technique - Expérimentations</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table des matières</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgdc2eeae">1. GH x MVL</a>
<ul>
<li><a href="#orgc6bbdf2">1.1. Exemple</a></li>
<li><a href="#cas-1-données-btcusdc-5min">1.2. Données BTC/USDC 5min</a>
<ul>
<li><a href="#évaluations">1.2.1. Évaluation ponctuelle</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgdc2eeae" class="outline-2">
<h2 id="orgdc2eeae"><span class="section-number-2">1.</span> GH x MVL</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #F0DFAF; font-weight: bold;">import</span> os
<span style="color: #F0DFAF; font-weight: bold;">import</span> sys
<span style="color: #F0DFAF; font-weight: bold;">import</span> tqdm
<span style="color: #F0DFAF; font-weight: bold;">import</span> yaml
<span style="color: #F0DFAF; font-weight: bold;">import</span> pandas <span style="color: #F0DFAF; font-weight: bold;">as</span> pd
<span style="color: #F0DFAF; font-weight: bold;">import</span> plotly.express <span style="color: #F0DFAF; font-weight: bold;">as</span> px
<span style="color: #F0DFAF; font-weight: bold;">import</span> plotly.graph_objects <span style="color: #F0DFAF; font-weight: bold;">as</span> go
<span style="color: #F0DFAF; font-weight: bold;">import</span> plotly.io <span style="color: #F0DFAF; font-weight: bold;">as</span> pio
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Custom remote librairies</span>
<span style="color: #F0DFAF; font-weight: bold;">import</span> mosaic
<span style="color: #F0DFAF; font-weight: bold;">import</span> mosaic.utils <span style="color: #F0DFAF; font-weight: bold;">as</span> mu
<span style="color: #F0DFAF; font-weight: bold;">import</span> mosaic.indicator <span style="color: #F0DFAF; font-weight: bold;">as</span> mi
<span style="color: #F0DFAF; font-weight: bold;">import</span> mosaic.scores <span style="color: #F0DFAF; font-weight: bold;">as</span> ms
<span style="color: #F0DFAF; font-weight: bold;">import</span> mosaic.database <span style="color: #F0DFAF; font-weight: bold;">as</span> md

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Util functions</span>
<span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">isnumeric</span>(x):
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #F0DFAF; font-weight: bold;">return</span> <span style="color: #DCDCCC; font-weight: bold;">isinstance</span>(x, (<span style="color: #DCDCCC; font-weight: bold;">int</span>, <span style="color: #DCDCCC; font-weight: bold;">float</span>))
</pre>
</div>

<style type="text/css">
</style>
<table id="T_ee1e7">
  <thead>
    <tr>
      <th id="T_ee1e7_level0_col0" class="col_heading level0 col0" >Library</th>
      <th id="T_ee1e7_level0_col1" class="col_heading level0 col1" >Version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_ee1e7_row0_col0" class="data row0 col0" >MOSAIC</td>
      <td id="T_ee1e7_row0_col1" class="data row0 col1" >0.0.12</td>
    </tr>
  </tbody>
</table>
</div>

<div id="outline-container-orgc6bbdf2" class="outline-3">
<h3 id="orgc6bbdf2"><span class="section-number-3">1.1.</span> Exemple</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Données utilisées :
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">config</span> = {
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"collection"</span>: <span style="color: #CC9393;">"crypto"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"name"</span>: <span style="color: #CC9393;">"ohlcv"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"tags"</span>: {
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"period"</span>: <span style="color: #CC9393;">"5m"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"exchange"</span>: <span style="color: #CC9393;">"binance"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"base"</span>: <span style="color: #CC9393;">"BTC"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"quote"</span>: <span style="color: #CC9393;">"USDC"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   },
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"values"</span>: [<span style="color: #CC9393;">"open"</span>, <span style="color: #CC9393;">"high"</span>, <span style="color: #CC9393;">"low"</span>, <span style="color: #CC9393;">"close"</span>, <span style="color: #CC9393;">"volume"</span>],
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"start_date"</span>: <span style="color: #CC9393;">'2021-01-01 00:00:00'</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"stop_date"</span>: <span style="color: #CC9393;">'2021-01-02 00:00:00'</span>,
}

<span style="color: #DFAF8F;">source</span> = md.InfluxDataSource(**config)

<span style="color: #DFAF8F;">source_filename</span> = os.path.join(
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   DATA_PATH,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   f<span style="color: #CC9393;">"{source.get_str_info()}_"</span>\
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   f<span style="color: #CC9393;">"{config['start_date']}_{config['stop_date']}.csv.bz2"</span>)

<span style="color: #F0DFAF; font-weight: bold;">if</span> os.path.exists(source_filename):
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DFAF8F;">ohlcv_ex_df</span> = pd.read_csv(source_filename,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> index_col=<span style="color: #CC9393;">"time"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> parse_dates=[<span style="color: #CC9393;">"time"</span>])
<span style="color: #F0DFAF; font-weight: bold;">else</span>:

<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DFAF8F;">ohlcv_ex_df</span> = \
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   client.get_data(source,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   start=config[<span style="color: #CC9393;">"start_date"</span>],
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   stop=config[<span style="color: #CC9393;">"stop_date"</span>])
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   ohlcv_ex_df.to_csv(source_filename, index=<span style="color: #BFEBBF;">True</span>)

yaml.dump(config)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #DFAF8F;">collection</span>: crypto
<span style="color: #DFAF8F;">name</span>: ohlcv
<span style="color: #DFAF8F;">start_date</span>: <span style="color: #CC9393;">'2021-01-01 00:00:00'</span>
<span style="color: #DFAF8F;">stop_date</span>: <span style="color: #CC9393;">'2021-01-02 00:00:00'</span>
<span style="color: #DFAF8F;">tags</span>:
  <span style="color: #DFAF8F;">base</span>: BTC
  <span style="color: #DFAF8F;">exchange</span>: binance
  <span style="color: #DFAF8F;">period</span>: 5m
  <span style="color: #DFAF8F;">quote</span>: USDC
<span style="color: #DFAF8F;">values</span>:
- open
- high
- low
- close
- volume
</pre>
</div>


<p>
Premières observations : 
</p>
<div class="org-src-container">
<pre class="src src-python">ohlcv_ex_df.head().style.<span style="color: #DCDCCC; font-weight: bold;">format</span>(precision=2, thousands=<span style="color: #CC9393;">" "</span>).to_html()
</pre>
</div>

<style type="text/css">
</style>
<table id="T_1a188">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_1a188_level0_col0" class="col_heading level0 col0" >open</th>
      <th id="T_1a188_level0_col1" class="col_heading level0 col1" >high</th>
      <th id="T_1a188_level0_col2" class="col_heading level0 col2" >low</th>
      <th id="T_1a188_level0_col3" class="col_heading level0 col3" >close</th>
      <th id="T_1a188_level0_col4" class="col_heading level0 col4" >volume</th>
    </tr>
    <tr>
      <th class="index_name level0" >time</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_1a188_level0_row0" class="row_heading level0 row0" >2021-01-01 00:00:00+00:00</th>
      <td id="T_1a188_row0_col0" class="data row0 col0" >28 964.54</td>
      <td id="T_1a188_row0_col1" class="data row0 col1" >29 064.55</td>
      <td id="T_1a188_row0_col2" class="data row0 col2" >28 958.66</td>
      <td id="T_1a188_row0_col3" class="data row0 col3" >29 018.17</td>
      <td id="T_1a188_row0_col4" class="data row0 col4" >8.77</td>
    </tr>
    <tr>
      <th id="T_1a188_level0_row1" class="row_heading level0 row1" >2021-01-01 00:05:00+00:00</th>
      <td id="T_1a188_row1_col0" class="data row1 col0" >28 993.74</td>
      <td id="T_1a188_row1_col1" class="data row1 col1" >28 996.04</td>
      <td id="T_1a188_row1_col2" class="data row1 col2" >28 890.99</td>
      <td id="T_1a188_row1_col3" class="data row1 col3" >28 914.30</td>
      <td id="T_1a188_row1_col4" class="data row1 col4" >11.15</td>
    </tr>
    <tr>
      <th id="T_1a188_level0_row2" class="row_heading level0 row2" >2021-01-01 00:10:00+00:00</th>
      <td id="T_1a188_row2_col0" class="data row2 col0" >28 902.53</td>
      <td id="T_1a188_row2_col1" class="data row2 col1" >28 908.49</td>
      <td id="T_1a188_row2_col2" class="data row2 col2" >28 741.86</td>
      <td id="T_1a188_row2_col3" class="data row2 col3" >28 790.00</td>
      <td id="T_1a188_row2_col4" class="data row2 col4" >4.58</td>
    </tr>
    <tr>
      <th id="T_1a188_level0_row3" class="row_heading level0 row3" >2021-01-01 00:15:00+00:00</th>
      <td id="T_1a188_row3_col0" class="data row3 col0" >28 798.99</td>
      <td id="T_1a188_row3_col1" class="data row3 col1" >28 891.63</td>
      <td id="T_1a188_row3_col2" class="data row3 col2" >28 798.29</td>
      <td id="T_1a188_row3_col3" class="data row3 col3" >28 884.38</td>
      <td id="T_1a188_row3_col4" class="data row3 col4" >4.31</td>
    </tr>
    <tr>
      <th id="T_1a188_level0_row4" class="row_heading level0 row4" >2021-01-01 00:20:00+00:00</th>
      <td id="T_1a188_row4_col0" class="data row4 col0" >28 845.04</td>
      <td id="T_1a188_row4_col1" class="data row4 col1" >28 886.67</td>
      <td id="T_1a188_row4_col2" class="data row4 col2" >28 789.15</td>
      <td id="T_1a188_row4_col3" class="data row4 col3" >28 885.73</td>
      <td id="T_1a188_row4_col4" class="data row4 col4" >13.21</td>
    </tr>
  </tbody>
</table>

<p>
Initialisation des indicateurs :
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">mvl_indic_ex</span> = mi.MVLIndicator(window=12, levels=[0.5, 0.75], indic_fmt=<span style="color: #CC9393;">"MVL{window}"</span>)
<span style="color: #DFAF8F;">gh_indic_ex</span> = mi.GHIndicator(alpha=0.001, beta=0.75, labels=[<span style="color: #CC9393;">"-"</span>, <span style="color: #CC9393;">"="</span>, <span style="color: #CC9393;">"+"</span>])
</pre>
</div>

<p>
Calcul des indicateurs :
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">ohlcv_mvl_indic_ex_df</span> = \
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   mvl_indic_ex.compute(ohlcv_ex_df)
<span style="color: #DFAF8F;">ohlcv_gh_indic_ex_df</span> = \
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   gh_indic_ex.compute(ohlcv_ex_df)

pd.concat([ohlcv_mvl_indic_ex_df,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>  ohlcv_gh_indic_ex_df], axis=1).head().style.to_html()
</pre>
</div>

<style type="text/css">
</style>
<table id="T_c3bb7">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_c3bb7_level0_col0" class="col_heading level0 col0" >MVL12</th>
      <th id="T_c3bb7_level0_col1" class="col_heading level0 col1" >GH</th>
      <th id="T_c3bb7_level0_col2" class="col_heading level0 col2" >GHd</th>
    </tr>
    <tr>
      <th class="index_name level0" >time</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_c3bb7_level0_row0" class="row_heading level0 row0" >2021-01-01 00:00:00+00:00</th>
      <td id="T_c3bb7_row0_col0" class="data row0 col0" >nan</td>
      <td id="T_c3bb7_row0_col1" class="data row0 col1" >0.755174</td>
      <td id="T_c3bb7_row0_col2" class="data row0 col2" >+</td>
    </tr>
    <tr>
      <th id="T_c3bb7_level0_row1" class="row_heading level0 row1" >2021-01-01 00:05:00+00:00</th>
      <td id="T_c3bb7_row1_col0" class="data row1 col0" >nan</td>
      <td id="T_c3bb7_row1_col1" class="data row1 col1" >-0.264476</td>
      <td id="T_c3bb7_row1_col2" class="data row1 col2" >=</td>
    </tr>
    <tr>
      <th id="T_c3bb7_level0_row2" class="row_heading level0 row2" >2021-01-01 00:10:00+00:00</th>
      <td id="T_c3bb7_row2_col0" class="data row2 col0" >nan</td>
      <td id="T_c3bb7_row2_col1" class="data row2 col1" >-0.374833</td>
      <td id="T_c3bb7_row2_col2" class="data row2 col2" >=</td>
    </tr>
    <tr>
      <th id="T_c3bb7_level0_row3" class="row_heading level0 row3" >2021-01-01 00:15:00+00:00</th>
      <td id="T_c3bb7_row3_col0" class="data row3 col0" >nan</td>
      <td id="T_c3bb7_row3_col1" class="data row3 col1" >0.076707</td>
      <td id="T_c3bb7_row3_col2" class="data row3 col2" >=</td>
    </tr>
    <tr>
      <th id="T_c3bb7_level0_row4" class="row_heading level0 row4" >2021-01-01 00:20:00+00:00</th>
      <td id="T_c3bb7_row4_col0" class="data row4 col0" >nan</td>
      <td id="T_c3bb7_row4_col1" class="data row4 col1" >-1.350455</td>
      <td id="T_c3bb7_row4_col2" class="data row4 col2" >-</td>
    </tr>
  </tbody>
</table>
</div>
</div>


<div id="outline-container-cas-1-données-btcusdc-5min" class="outline-3">
<h3 id="cas-1-données-btcusdc-5min"><span class="section-number-3">1.2.</span> Données BTC/USDC 5min</h3>
<div class="outline-text-3" id="text-cas-1-données-btcusdc-5min">
<p>
Caractéristiques de la source de données utilisée :
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">config</span> = {
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"collection"</span>: <span style="color: #CC9393;">"crypto"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"name"</span>: <span style="color: #CC9393;">"ohlcv"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"tags"</span>: {
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"exchange"</span>: <span style="color: #CC9393;">"binance"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"base"</span>: <span style="color: #CC9393;">"BTC"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"quote"</span>: <span style="color: #CC9393;">"USDC"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"period"</span>: <span style="color: #CC9393;">"5m"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   },
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"values"</span>: [<span style="color: #CC9393;">"open"</span>, <span style="color: #CC9393;">"high"</span>, <span style="color: #CC9393;">"low"</span>, <span style="color: #CC9393;">"close"</span>, <span style="color: #CC9393;">"volume"</span>],
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"start_date"</span>: <span style="color: #CC9393;">'2021-01-01 00:00:00'</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #CC9393;">"stop_date"</span>: <span style="color: #CC9393;">'2022-01-01 00:00:00'</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   }

<span style="color: #DFAF8F;">source</span> = md.InfluxDataSource(**config)

<span style="color: #DFAF8F;">source_filename</span> = os.path.join(
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   DATA_PATH,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   f<span style="color: #CC9393;">"{source.get_str_info()}_"</span>\
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   f<span style="color: #CC9393;">"{config['start_date']}_{config['stop_date']}.csv.bz2"</span>)

<span style="color: #F0DFAF; font-weight: bold;">if</span> os.path.exists(source_filename):
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DFAF8F;">ohlcv_df</span> = pd.read_csv(source_filename,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> index_col=<span style="color: #CC9393;">"time"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> parse_dates=[<span style="color: #CC9393;">"time"</span>])
<span style="color: #F0DFAF; font-weight: bold;">else</span>:

<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DFAF8F;">ohlcv_df</span> = \
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   client.get_data(source,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   start=config[<span style="color: #CC9393;">"start_date"</span>],
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   stop=config[<span style="color: #CC9393;">"stop_date"</span>])
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   ohlcv_df.to_csv(source_filename, index=<span style="color: #BFEBBF;">True</span>)

yaml.dump(config)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #DFAF8F;">collection</span>: crypto
<span style="color: #DFAF8F;">name</span>: ohlcv
<span style="color: #DFAF8F;">start_date</span>: <span style="color: #CC9393;">'2021-01-01 00:00:00'</span>
<span style="color: #DFAF8F;">stop_date</span>: <span style="color: #CC9393;">'2022-01-01 00:00:00'</span>
<span style="color: #DFAF8F;">tags</span>:
  <span style="color: #DFAF8F;">base</span>: BTC
  <span style="color: #DFAF8F;">exchange</span>: binance
  <span style="color: #DFAF8F;">period</span>: 5m
  <span style="color: #DFAF8F;">quote</span>: USDC
<span style="color: #DFAF8F;">values</span>:
- open
- high
- low
- close
- volume
</pre>
</div>

<p>
Préparation pour le calcul du score PAWER sur les données :
</p>
<div class="org-src-container">
<pre class="src src-python">importlib.<span style="color: #DCDCCC; font-weight: bold;">reload</span>(ms)
<span style="color: #DFAF8F;">score_pawer</span> = ms.PAWERScore(horizon=<span style="color: #DCDCCC; font-weight: bold;">list</span>(<span style="color: #DCDCCC; font-weight: bold;">range</span>(0, 24)))
score_pawer.fit(ohlcv_df)
</pre>
</div>
</div>

<div id="outline-container-évaluations" class="outline-4">
<h4 id="évaluations"><span class="section-number-4">1.2.1.</span> Évaluation ponctuelle</h4>
<div class="outline-text-4" id="text-évaluations">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">mvl_indic</span> = mi.MVLIndicator(
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   window=10,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   levels=[0.1, 0.25, 0.5, 0.75, 0.9])
<span style="color: #DFAF8F;">gh_indic</span> = mi.GHIndicator(alpha=0.0075,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> beta=0.75,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> labels=[<span style="color: #CC9393;">"-"</span>, <span style="color: #CC9393;">"="</span>, <span style="color: #CC9393;">"+"</span>])

<span style="color: #DFAF8F;">indics_df</span> = pd.concat([mu.lag(mvl_indic.compute(ohlcv_df), 1),
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>  mu.lag(gh_indic.compute(ohlcv_df), 1)],
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> axis=1)

<span style="color: #DFAF8F;">indics_names</span> = [<span style="color: #CC9393;">"MVL[-1]"</span>, <span style="color: #CC9393;">"GHd[-1]"</span>]
<span style="color: #DFAF8F;">indics_names_joined</span> = <span style="color: #CC9393;">"|"</span>.join(indics_names)
</pre>
</div>

<p>
Occurrences de l'indicateur discrétisé :
</p>
<div class="org-src-container">
<pre class="src src-python">indics_df[indics_names].value_counts()\
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>  .rename(<span style="color: #CC9393;">"#Occ"</span>)\
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>  .to_frame()\
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>  .style.to_html()
</pre>
</div>

<style type="text/css">
</style>
<table id="T_c94d0">
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_c94d0_level0_col0" class="col_heading level0 col0" >#Occ</th>
    </tr>
    <tr>
      <th class="index_name level0" >MVL[-1]</th>
      <th class="index_name level1" >GHd[-1]</th>
      <th class="blank col0" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_c94d0_level0_row0" class="row_heading level0 row0" >l10_25</th>
      <th id="T_c94d0_level1_row0" class="row_heading level1 row0" >=</th>
      <td id="T_c94d0_row0_col0" class="data row0 col0" >21353</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row1" class="row_heading level0 row1" >l75_90</th>
      <th id="T_c94d0_level1_row1" class="row_heading level1 row1" >=</th>
      <td id="T_c94d0_row1_col0" class="data row1 col0" >20148</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row2" class="row_heading level0 row2" >l50_75</th>
      <th id="T_c94d0_level1_row2" class="row_heading level1 row2" >=</th>
      <td id="T_c94d0_row2_col0" class="data row2 col0" >19974</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row3" class="row_heading level0 row3" >l25_50</th>
      <th id="T_c94d0_level1_row3" class="row_heading level1 row3" >=</th>
      <td id="T_c94d0_row3_col0" class="data row3 col0" >19904</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row4" class="row_heading level0 row4" >l0_10</th>
      <th id="T_c94d0_level1_row4" class="row_heading level1 row4" >=</th>
      <td id="T_c94d0_row4_col0" class="data row4 col0" >12111</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row5" class="row_heading level0 row5" rowspan="2">l90_100</th>
      <th id="T_c94d0_level1_row5" class="row_heading level1 row5" >=</th>
      <td id="T_c94d0_row5_col0" class="data row5 col0" >11239</td>
    </tr>
    <tr>
      <th id="T_c94d0_level1_row6" class="row_heading level1 row6" >-</th>
      <td id="T_c94d0_row6_col0" class="data row6 col0" >34</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row7" class="row_heading level0 row7" rowspan="2">l75_90</th>
      <th id="T_c94d0_level1_row7" class="row_heading level1 row7" >-</th>
      <td id="T_c94d0_row7_col0" class="data row7 col0" >22</td>
    </tr>
    <tr>
      <th id="T_c94d0_level1_row8" class="row_heading level1 row8" >+</th>
      <td id="T_c94d0_row8_col0" class="data row8 col0" >20</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row9" class="row_heading level0 row9" rowspan="2">l50_75</th>
      <th id="T_c94d0_level1_row9" class="row_heading level1 row9" >+</th>
      <td id="T_c94d0_row9_col0" class="data row9 col0" >13</td>
    </tr>
    <tr>
      <th id="T_c94d0_level1_row10" class="row_heading level1 row10" >-</th>
      <td id="T_c94d0_row10_col0" class="data row10 col0" >12</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row11" class="row_heading level0 row11" >l90_100</th>
      <th id="T_c94d0_level1_row11" class="row_heading level1 row11" >+</th>
      <td id="T_c94d0_row11_col0" class="data row11 col0" >9</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row12" class="row_heading level0 row12" rowspan="2">l25_50</th>
      <th id="T_c94d0_level1_row12" class="row_heading level1 row12" >-</th>
      <td id="T_c94d0_row12_col0" class="data row12 col0" >7</td>
    </tr>
    <tr>
      <th id="T_c94d0_level1_row13" class="row_heading level1 row13" >+</th>
      <td id="T_c94d0_row13_col0" class="data row13 col0" >6</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row14" class="row_heading level0 row14" >l10_25</th>
      <th id="T_c94d0_level1_row14" class="row_heading level1 row14" >+</th>
      <td id="T_c94d0_row14_col0" class="data row14 col0" >3</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row15" class="row_heading level0 row15" >l0_10</th>
      <th id="T_c94d0_level1_row15" class="row_heading level1 row15" >+</th>
      <td id="T_c94d0_row15_col0" class="data row15 col0" >3</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row16" class="row_heading level0 row16" >l10_25</th>
      <th id="T_c94d0_level1_row16" class="row_heading level1 row16" >-</th>
      <td id="T_c94d0_row16_col0" class="data row16 col0" >1</td>
    </tr>
    <tr>
      <th id="T_c94d0_level0_row17" class="row_heading level0 row17" >l0_10</th>
      <th id="T_c94d0_level1_row17" class="row_heading level1 row17" >-</th>
      <td id="T_c94d0_row17_col0" class="data row17 col0" >1</td>
    </tr>
  </tbody>
</table>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">level_risk</span> = 0.5
<span style="color: #DFAF8F;">pawer_indic</span> = score_pawer.compute(indic=indics_df[indics_names],
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> level_risk=level_risk)
<span style="color: #DFAF8F;">pawer_indic_bis</span> = pd.melt(pawer_indic,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> ignore_index=<span style="color: #BFEBBF;">False</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> var_name=<span style="color: #CC9393;">"period"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> value_name=<span style="color: #CC9393;">"returns"</span>)
<span style="color: #DFAF8F;">pawer_indic_bis</span>[indics_names_joined] = \
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   pawer_indic_bis.index.<span style="color: #DCDCCC; font-weight: bold;">map</span>(<span style="color: #F0DFAF; font-weight: bold;">lambda</span> x: <span style="color: #CC9393;">"|"</span>.join([<span style="color: #DCDCCC; font-weight: bold;">str</span>(i) <span style="color: #F0DFAF; font-weight: bold;">for</span> i <span style="color: #F0DFAF; font-weight: bold;">in</span> x]))
pawer_indic_bis.reset_index(drop=<span style="color: #BFEBBF;">True</span>, inplace=<span style="color: #BFEBBF;">True</span>)

<span style="color: #DFAF8F;">fig</span> = px.line(pawer_indic_bis,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> x=<span style="color: #CC9393;">"period"</span>, y=<span style="color: #CC9393;">"returns"</span>, color=indics_names_joined,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> markers=<span style="color: #BFEBBF;">True</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> title=f<span style="color: #CC9393;">"Score PAWER des indicateurs {indics_names_joined} "</span>\
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span> f<span style="color: #CC9393;">"au niveau de risque={level_risk}"</span>)

pio.to_html(fig, include_plotlyjs=<span style="color: #CC9393;">"cdn"</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   full_html=<span style="color: #BFEBBF;">False</span>,
<span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   <span style="color: #DCDCCC; background-color: #4F4F4F;"> </span>   config={<span style="color: #CC9393;">'displayModeBar'</span>: <span style="color: #BFEBBF;">False</span>})

fig.show()
</pre>
</div>

None
</div>
</div>
</div>
</div>
</div>
</body>
</html>
